
syntax = "proto3";

package he_proto;

message TCPMessage {
  Function function = 1;
  EncryptionParameters encryption_parameters = 2;
  EvaluationKey eval_key = 3;
  PublicKey public_key = 4;
  repeated SealCiphertextWrapper ciphers = 5;
}

message EncryptionParameters {
  bytes encryption_parameters = 1;
  enum Type {
    UNKNOWN = 0;
    REQUEST = 1;
    RESPONSE = 2;
  }
  Type type = 2;
}

message EvaluationKey {
  bytes eval_key = 1;
  enum Type {
    UNKNOWN = 0;
    REQUEST = 1;
    RESPONSE = 2;
  }
  Type type = 2;
}

message PublicKey {
  bytes public_key = 1;
  enum Type {
    UNKNOWN = 0;
    REQUEST = 1;
    RESPONSE = 2;
  }
  Type type = 2;
}

message Function {
  string function = 1;
}

message SealCiphertextWrapper {
  bool known_value = 1;
  float value = 2;
  bytes ciphertext = 3;
}